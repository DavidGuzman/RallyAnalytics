<html><head><title>Analytics 2.0 Lookback API Getting Started Guide</title><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=lhDjYqiy3mZ0x6ROQEUoUw');ol{margin:0;padding:0}.c9{list-style-type:decimal;margin:0;padding:0}.c16{list-style-type:circle;margin:0;padding:0}.c4{list-style-type:disc;margin:0;padding:0}.c0{direction:ltr;margin-left:36pt}.c12{color:#1155cc;text-decoration:underline}.c8{max-width:517.5pt;padding:72pt 40.5pt 72pt 54pt}.c18{color:inherit;text-decoration:inherit}.c2{color:#222222;background-color:#ffffff}.c17{font-family:"Consolas"}.c15{margin-left:72pt}.c13{margin-left:54pt}.c7{background-color:#ffffff}.c10{margin-right:-9pt}.c19{margin-left:18pt}.c11{font-weight:bold}.c5{height:11pt}.c3{direction:ltr}.c1{padding-left:0pt}.c14{text-indent:36pt}.c6{font-family:"Courier New"}.title{padding-top:24pt;line-height:1.15;text-align:left;color:#000000;font-size:36pt;font-family:"Arial";font-weight:bold;padding-bottom:6pt}.subtitle{padding-top:18pt;line-height:1.15;text-align:left;color:#666666;font-style:italic;font-size:24pt;font-family:"Georgia";padding-bottom:4pt}p{color:#000000;font-size:11pt;margin:0;font-family:"Arial"}h1{padding-top:24pt;line-height:1.15;text-align:left;color:#000000;font-size:24pt;font-family:"Arial";font-weight:bold;padding-bottom:6pt}h2{padding-top:18pt;line-height:1.15;text-align:left;color:#000000;font-size:18pt;font-family:"Arial";font-weight:bold;padding-bottom:4pt}h3{padding-top:14pt;line-height:1.15;text-align:left;color:#000000;font-size:14pt;font-family:"Arial";font-weight:bold;padding-bottom:4pt}h4{padding-top:12pt;line-height:1.15;text-align:left;color:#000000;font-size:12pt;font-family:"Arial";font-weight:bold;padding-bottom:2pt}h5{padding-top:11pt;line-height:1.15;text-align:left;color:#000000;font-size:11pt;font-family:"Arial";font-weight:bold;padding-bottom:2pt}h6{padding-top:10pt;line-height:1.15;text-align:left;color:#000000;font-size:10pt;font-family:"Arial";font-weight:bold;padding-bottom:2pt}</style></head><body class="c7 c8"><h1 class="c3"><a name="h.isbcbplgns3b"></a><span>Rally Lookback API Getting Started Guide</span></h1><p class="c3"><span class="c12"><a class="c18" href="https://docs.google.com/a/rallydev.com/document/d/1QySvFx9L9dsXf2ULgJzAE2GjhYv56RSWhWHF87oyX4M/edit">ORIGINAL DOCUMENT</a></span><span>&nbsp;(must have rallydev.com email to access)</span></p><p class="c5 c3"><span></span></p><p class="c3 c19"><span class="c12"><a class="c18" href="#h.isbcbplgns3b">Rally Lookback API Getting Started Guide</a></span></p><p class="c0"><span class="c12"><a class="c18" href="#h.uw29wij0t8kd">Purpose and caveats</a></span></p><p class="c0"><span class="c12"><a class="c18" href="#h.w2wj2gj251kp">Documentation</a></span></p><p class="c0"><span class="c12"><a class="c18" href="#h.j0m8ag3vzr0c">How to access</a></span></p><p class="c3 c13"><span class="c12"><a class="c18" href="#h.ho920x6orvmw">Querying via GET</a></span></p><p class="c13 c3"><span class="c12"><a class="c18" href="#h.ybe8qfn1ummw">Querying via POST</a></span></p><p class="c0"><span class="c12"><a class="c18" href="#h.engxa3kfrir4">Limitations:</a></span></p><p class="c0"><span class="c12"><a class="c18" href="#h.u8hp3yhikf2u">Endpoints</a></span></p><p class="c0"><span class="c12"><a class="c18" href="#h.moywkdo7gfy8">Additional functionality as of 2012-03-11</a></span></p><p class="c0"><span class="c12"><a class="c18" href="#h.fodrhovf6xwf">Backward breaking changes as of 2012-03-11</a></span></p><h2 class="c3"><a name="h.uw29wij0t8kd"></a><span>Purpose and caveats</span></h2><p class="c3"><span>The </span><span class="c11">purpose</span><span>&nbsp;of this early-access preview is two-fold:</span></p><ol class="c9" start="1"><li class="c0 c1"><span class="c11">To provide Rally customers with a chance to start building Apps</span><span>&nbsp;upon this new powerful API. Several of our customers in this early-access were holding off on upgrading their existing Rally Apps because it is much easier to do certain things with this new API. We know it will take a little while for you to roll new functionality out to your Rally users and wanted to give you a head-start on that.</span></li><li class="c0 c1"><span class="c11">To give us early feedback from actual usage</span><span>. This is a new data model and stack (MongoDB) for Rally and we want a chance to work out the bumps with our closest partners before rolling it out to everyone. This early-access preview is very much in the spirit of Agile&#39;s &quot;learning by doing&quot; approach.</span></li></ol><p class="c3 c5"><span></span></p><p class="c3"><span>Due to the nature of this being an early-access preview (some might use the term Alpha), there are a few </span><span class="c11">caveats</span><span>, you want to keep in mind:</span></p><ol class="c9" start="1"><li class="c0 c1"><span class="c11">We know of a few things that don&#39;t work as expected</span><span>&nbsp;(see Limitations section below) </span><span class="c11">and we&#39;re still finding more</span><span>. Most of the unexpected behavior we are finding now is related to edge cases with the way Rally reports changes to the Analytics engine. We are dealing with most of them as they come up but some of them require changes to Rally that could take a while to resolve.</span></li><li class="c0 c1"><span class="c11">You will see debug information (stack traces) that will eventually be hidden behind an error response.</span></li><li class="c0 c1"><span class="c11">We will take the service down from time to time</span><span>&nbsp;to load a new version and modify the data model. Feel free to email me at </span><span class="c12"><a class="c18" href="mailto:Larry.Maccherone@rallydev.com">Larry.Maccherone@rallydev.com</a></span><span>&nbsp;if the services is non-responsive.</span></li><li class="c0 c1"><span class="c11">We are still adding functionality and we may still make backward breaking changes</span><span>&nbsp;if we find features that don&#39;t hold up under load or introduce some risk.</span></li></ol><h2 class="c3"><a name="h.w2wj2gj251kp"></a><span>Documentation</span></h2><p class="c3"><span>The hub for documentation about this effort is on GitHub at </span><span class="c12"><a class="c18" href="https://github.com/RallyApps/rally_analytics">https://github.com/RallyApps/rally_analytics</a></span></p><h2 class="c3"><a name="h.j0m8ag3vzr0c"></a><span>How to access</span></h2><h3 class="c3"><a name="h.ho920x6orvmw"></a><span>Querying via GET</span></h3><p class="c3"><span class="c7 c6">https://</span><span class="c7 c6">rally1.rallydev.com/</span><span class="c6">analytics/1.27/</span><span class="c7 c11 c6">41529001</span><span class="c6">/artifact/snapshot/</span><span class="c7 c6">query.js?find={ObjectID:</span><span class="c2 c11 c6">1443125795</span><span class="c7 c6">} </span></p><p class="c5 c3"><span class="c7"></span></p><p class="c3"><span class="c7">where </span><span class="c7 c11">41529001</span><span class="c7">&nbsp;is the ObjectID of the workspace and </span><span class="c2 c11">1443125795 </span><span class="c2">is the ObjectID of some work item (User Story, Defect, etc.) in your workspace.</span></p><p class="c5 c3 c14"><span class="c7"></span></p><p class="c3"><span class="c7">All endpoints respond to both GET and POST.</span></p><h3 class="c3"><a name="h.ybe8qfn1ummw"></a><span>Querying via</span><span>&nbsp;POST</span></h3><p class="c3"><span>You can use a Chrome plugin named XHR Poster or some other &quot;Poster&quot; plugin for your browser to try POSTs</span></p><p class="c5 c3"><span></span></p><p class="c3"><span class="c2 c11">URL</span><span class="c2 c11">:</span></p><p class="c3 c10"><span class="c6 c7">https://rally1.rallydev.com/</span><span class="c6">analytics/1.27/</span><span class="c7 c6">41529001</span><span class="c6">/artifact/snapshot/</span><span class="c7 c6">query.js</span></p><p class="c5 c3"><span class="c2 c11"></span></p><p class="c3"><span class="c2 c11">Content-Type</span><span class="c2 c11">:</span><span class="c2">&nbsp;</span><span class="c2 c6">application/json</span></p><p class="c5 c3"><span class="c2 c11"></span></p><p class="c3"><span class="c2 c11">Body</span><span class="c2 c11">:</span></p><p class="c3"><span class="c2 c6">{</span></p><p class="c3"><span class="c2 c6">&nbsp; &nbsp;&quot;find&quot;: { &quot;ObjectID&quot;: 1443125795 },</span></p><p class="c3"><span class="c2 c6">&nbsp; &nbsp;&quot;fields&quot;: true</span></p><p class="c3"><span class="c2 c6">}</span></p><p class="c5 c3"><span class="c2 c17"></span></p><p class="c3"><span class="c2">Use the &#39;POST&#39; button.</span></p><h2 class="c3"><a name="h.engxa3kfrir4"></a><span>L</span><span>imitations:</span></h2><ol class="c4" start="1"><li class="c0 c1"><span>Data only for early-access participants. Other subscriptions in the works. We will ramp up availability based upon the feedback from early-access users.</span></li><li class="c0 c1"><span>Double login. Your login to Rally proper is not known by the Lookback API. Your browser will prompt you to login again even if access from inside of Rally.</span></li><li class="c0 c1"><span>When developing (any time you hit it from outside of Rally), you may not be able to hit the API from IE or other browsers that do not support CORS.</span></li><li class="c0 c1"><span>We also have a bug where certain libraries send a pre-flight CORS request that we don&#39;t correctly process. This is fixed in testing but hasn&#39;t been rolled to production as of 2012-04-18. It should be out shortly.</span></li><li class="c0 c1"><span>Boolean and numeric fields are not set in the first snapshot for newly created Artifacts. This happened because they automatically default to false and 0 in our SQL database so Rally was not sending revision history transactions about them. We should have this fixed within a couple of weeks.</span></li><li class="c0 c1"><span>Newly created custom fields will not be query-able by string name until the next midnight after creation. We hope to integrate this look-up into the continuous ETL, but for now, newly created custom fields will not be available until midnight. Similarly, changes to allowed values will not show up until midnight.</span></li><li class="c0 c1"><span>No backward crawling ETL. This has several impacts</span></li></ol><ol class="c16" start="1"><li class="c3 c1 c15"><span>First, we only have data back to November 19.</span></li><li class="c15 c3 c1"><span>Also, snapshots don&#39;t look exactly the same. For instance, there is a _RevisionNumber field for the 1st snapshot but the _Revision, and _User (for the revision)</span></li></ol><ol class="c4" start="1"><li class="c0 c1"><span>Work item type prefixes (DE, S, US, TA, etc.) are currently hard coded when expanding queries against FormattedID, so if you&#39;ve changed them from the defaults (other than changing US to S), it will not work as expected. You can work around this by expanding into a query against _UnformattedID and _Type.</span></li><li class="c0 c1"><span>No easy syntax for querying iterations and releases. Right now you&#39;ll need to query Rally&#39;s standard WSAPI first to figure out the ObjectID of all iterations and releases that apply. Each Project has its own copy of the iteration/release data so if you need all the iteration/release data below a specific Project, you&#39;ll need the ObjectIDs of all of those iterations/releases. We don&#39;t like this so we&#39;re exploring ways to hide that messiness on the analytics side.</span></li><li class="c0 c1"><span>No disambiguation of Tag Names to ObjectIDs. For now, you&#39;ll need to provide the ObjectID for any queries against the Tags collection.</span></li><li class="c0 c1"><span>The example code for CFD and Burn charts does not yet handle well with artifacts that are deleted. We know what we have to do to fix this. We just have yet to implement the fix. The Cycle Time Scatter/Histogram example handles deletion (and even restoration) of artifacts as expected.</span></li><li class="c0 c1"><span>SSO nor LDAP will be supported.</span></li><li class="c0 c1"><span>Browser caching may make it hard to see the latest data without a refresh. We&#39;re looking at ways to avoid this in the future.</span></li></ol><h2 class="c3"><a name="h.u8hp3yhikf2u"></a><span>Endpoint</span></h2><ol class="c4" start="1"><li class="c0 c1"><span class="c6">/analytics/1.27/1234/artifact/snapshot/query.js?find:{_Type: &ldquo;Defect&rdquo;, </span><span class="c6">&quot;KanbanState&quot;:&quot;Accepted&quot;</span><sup><a href="#cmnt1" name="cmnt_ref1">[a]</a></sup><span class="c6">}</span></li></ol><h2 class="c3"><a name="h.moywkdo7gfy8"></a><span>Additional functionality as of 2012-03-11</span></h2><ol class="c4" start="1"><li class="c0 c1"><span>Live server data should now be available. Make a change in your Rally subscription and within a few seconds to a few minutes, the change should be represented in the Lookback API.</span></li><li class="c0 c1"><span>You can provide the string value for all fields where that makes sense. You still need to provide the foreign key ObjectID for fields that relate to another Artifact (eg Parent on HierarchicalRequirement), but now you can provide the string value for all other fields like &quot;Accepted&quot; for ScheduleState. Previously, you had to provide the ObjectID of the &quot;Accepted&quot; value (yes, every value has its own ObjectID).</span></li></ol><ol class="c16" start="1"><li class="c15 c3 c1"><span class="c17">find={_Type:&quot;Defect&quot;, KanbanState:&quot;Accepted&quot;}</span></li></ol><ol class="c4" start="3"><li class="c0 c1"><span>Non-custom fields support inequality comparisons (</span><span class="c17">$lt, $gt, $gte</span><span>, etc) using the order of the values you&#39;ve specified in Rally. So, &quot;Accepted&quot; is greater than &quot;In Progress&quot;. Note, inequality comparisons still do not work as expected for custom fields but we&#39;re close to fixing this.</span></li></ol><h2 class="c3"><a name="h.fodrhovf6xwf"></a><span>Backward breaking changes as of 2012-03-11</span></h2><ol class="c4" start="4"><li class="c0 c1"><span>$where is now blocked. The documentation always listed $where clauses as unsupported. Now we are actually blocking its use.</span></li><li class="c0 c1"><span>_PreviousValues keys must be quoted (proper JSON), or the query will fail to parse.</span></li></ol><ol class="c16" start="1"><li class="c15 c3 c1"><span class="c17">find={&quot;_PreviousValues.KanbanState&quot;:&quot;Accepted&quot;}</span></li></ol><ol class="c4" start="6"><li class="c0 c1"><span>Fields parameters must be proper JSON strings and quoted.</span></li></ol><ol class="c16" start="1"><li class="c15 c3 c1"><span class="c17">find={ObjectID:12345}&amp;fields=[&quot;KanbanState&quot;,&quot;_PreviousValues.KanbanState&quot;]</span></li></ol><ol class="c4" start="7"><li class="c0 c1"><span>_IsLeaf is no longer supported. In the documentation, we give examples of how to accomplish the same thing using other means with the same fast performance as _IsLeaf.</span></li><li class="c0 c1"><span>JSONP is not supported at this time. There were issues with using it in conjunction with basic authentication. We are exploring possibilities for cross-browser access including </span><span class="c12"><a class="c18" href="http://enable-cors.org/">CORS</a></span><span>&nbsp;and additional forms of authentication.</span></li></ol><p class="c5 c3"><span></span></p></body></html>